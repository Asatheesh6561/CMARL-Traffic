[INFO 15:45:05] main Experiment Parameters:
|                                      | HyperParameter Value                  |
|:-------------------------------------|:--------------------------------------|
| CM_selected_inner                    |                                       |
| NM_lane_embedding_size               | 32                                    |
| NM_phase_loss_weight                 | 0                                     |
| NM_phase_loss_with_replay            | False                                 |
| NM_road_predict_hidden               | 32                                    |
| NM_scale_by_lane_number              | False                                 |
| NM_volume_loss_weight                | 0                                     |
| agent                                |                                       |
| cityflow_log                         |                                       |
| config.accumulated_episodes          | 1                                     |
| config.action_selector               | epsilon_greedy                        |
| config.actor_input_seq_str           | o_la                                  |
| config.agent                         | n_rnn                                 |
| config.agent_output_type             | pi_logits                             |
| config.batch_size                    | 8                                     |
| config.batch_size_run                | 8                                     |
| config.buffer_cpu_only               | True                                  |
| config.buffer_size                   | 200                                   |
| config.checkpoint_path               |                                       |
| config.critic_input_seq_str          | o                                     |
| config.critic_type                   | maddpg_critic                         |
| config.epsilon_anneal_time           | 2000000                               |
| config.epsilon_finish                | 0.05                                  |
| config.epsilon_start                 | 1.0                                   |
| config.evaluate                      | False                                 |
| config.gamma                         | 0.985                                 |
| config.grad_norm_clip                | 5                                     |
| config.hidden_dim                    | 128                                   |
| config.learner                       | maddpg_learner                        |
| config.learner_log_interval          | 10000                                 |
| config.local_results_path            | /cmlscratch/anirudhs/cmarl_traffic    |
| config.log_interval                  | 10000                                 |
| config.lr                            | 0.0005                                |
| config.mac                           | maddpg_mac                            |
| config.mini_epochs                   | 1                                     |
| config.n_lambda                      | 51                                    |
| config.name                          | maddpg                                |
| config.obs_agent_id                  | True                                  |
| config.obs_individual_obs            | False                                 |
| config.obs_last_action               | False                                 |
| config.optim                         | Adam                                  |
| config.optim_alpha                   | 0.99                                  |
| config.optim_eps                     | 1e-05                                 |
| config.reg                           | 0.001                                 |
| config.run                           | maddpg_run                            |
| config.runner                        | episode                               |
| config.sampling_lambda_index         | 0                                     |
| config.save_model                    | False                                 |
| config.save_model_interval           | 1460000                               |
| config.save_probs                    | False                                 |
| config.save_replay                   | False                                 |
| config.standardise_returns           | False                                 |
| config.standardise_rewards           | True                                  |
| config.t_max                         | 2000000                               |
| config.target_update_interval_or_tau | 200                                   |
| config.test_greedy                   | True                                  |
| config.test_interval                 | 20000                                 |
| config.test_nepisode                 | 8                                     |
| config.use_cuda                      | True                                  |
| config.use_double_q                  | True                                  |
| config.use_individual_rewards        | True                                  |
| config.use_layer_norm                | False                                 |
| config.use_loss_normalization        | False                                 |
| config.use_mean_team_reward          | False                                 |
| config.use_n_lambda                  | False                                 |
| config.use_orthogonal                | False                                 |
| config.use_reward_normalization      | True                                  |
| config.use_sample_prob_weights       | True                                  |
| config.use_single_lambda_sampling    | False                                 |
| config.use_tensorboard               | False                                 |
| config.use_wandb                     | True                                  |
| config.visualize                     | False                                 |
| config.visualize_interval            | 500000                                |
| config.wandb_project_name            | ctraffic                              |
| config.whittle_hidden_dim            | 128                                   |
| constraint                           | green_time                            |
| development                          | False                                 |
| enable_wandb                         | True                                  |
| env                                  | ctraffic                              |
| evaluate_interval                    | 10                                    |
| evaluate_round                       | 10                                    |
| feature_hidden_size                  | 512                                   |
| fixed_time                           | 30                                    |
| gamma                                | 0.99                                  |
| gammas                               | 0.99                                  |
| gpu_to_use                           |                                       |
| green_skip_penalty                   | 0.2                                   |
| green_time_penalty                   | 0.2                                   |
| learning_rate                        | 0.0001                                |
| log_folder                           | logs/                                 |
| log_interval                         | 100                                   |
| main                                 |                                       |
| mode                                 | train                                 |
| model                                |                                       |
| model_save_path                      |                                       |
| multi_agent                          |                                       |
| n_frames                             | 1000000                               |
| n_steps                              | 5                                     |
| name                                 | maddpg                                |
| no_cuda                              | False                                 |
| phase_skip_penalty                   | 0.2                                   |
| preload_model_file                   |                                       |
| render_steps                         | -1                                    |
| results_path                         | /cmlscratch/anirudhs/ctraffic/results |
| save_interval                        | 0                                     |
| seed                                 | 591688192                             |
| simulate_time                        | 360                                   |
| target_reward                        | 1e+100                                |
| tensorboardx_comment                 |                                       |
| test_round                           | 0                                     |
| threads                              | 16                                    |
| use_cuda                             | True                                  |
| wandb_api_key                        |                                       |
| wandb_entity_name                    | anirudh-satheesh                      |
| wandb_project_name                   | ctraffic                              |
| wandb_sync_mode                      | online                                |
| work_folder                          | ./                                    |
| wrapper_model                        |                                       |
[INFO 15:45:06] main MDP Components:
|                    | vshape   | group   | dtype         |
|:-------------------|:---------|:--------|:--------------|
| actions            | (1,)     | agents  | torch.int64   |
| actions_onehot     | (8,)     | agents  | torch.float32 |
| avail_actions      | (8,)     | agents  | torch.int32   |
| filled             | (1,)     |         | torch.int64   |
| individual_rewards | (1,)     | agents  |               |
| mean_action        | (8,)     | agents  | torch.float32 |
| obs                | 204      | agents  |               |
| probs              | (8,)     | agents  | torch.float32 |
| reward             | (1,)     |         |               |
| state              | 2448.0   |         |               |
| terminated         | (1,)     |         | torch.uint8   |
| total_reward       | (1,)     |         |               |
Input Shape: 2472
[INFO 15:45:09] main Beginning training for 2000000 timesteps
[INFO 15:50:54] main Recent Stats | t_env:      10080 | Episode:      216
agent_grad_norm:           0.0013	critic_grad_norm:         51.8205	critic_loss:               1.0390	pg_loss:                  -0.2198
q_taken_mean:              0.8791	target_mean:               0.8508	td_error_abs:              0.8719	
[INFO 15:56:30] main t_env: 20160 / 2000000
[INFO 15:56:30] main Estimated time left: 18 hours, 33 minutes, 53 seconds. Time passed: 11 minutes, 20 seconds
new test result : -1177.663273250001
[INFO 15:56:41] main Recent Stats | t_env:      20160 | Episode:      440
agent_grad_norm:           0.0007	critic_grad_norm:         51.1161	critic_loss:               0.7468	pg_loss:                  -0.1104
q_taken_mean:              0.4324	target_mean:               0.6505	td_error_abs:              0.7238	
[INFO 16:02:20] main Recent Stats | t_env:      30240 | Episode:      664
agent_grad_norm:           0.0003	critic_grad_norm:         50.4691	critic_loss:               0.6186	pg_loss:                  -0.0329
q_taken_mean:              0.2789	target_mean:               0.5627	td_error_abs:              0.6511	
[INFO 16:08:01] main t_env: 40320 / 2000000
[INFO 16:08:01] main Estimated time left: 18 hours, 39 minutes, 41 seconds. Time passed: 22 minutes, 51 seconds
[INFO 16:08:12] main Recent Stats | t_env:      40320 | Episode:      888
agent_grad_norm:           0.0000	critic_grad_norm:         41.3419	critic_loss:               0.5034	pg_loss:                  -0.0853
q_taken_mean:              0.1878	target_mean:               0.3896	td_error_abs:              0.5616	
[INFO 16:13:46] main Recent Stats | t_env:      50400 | Episode:     1112
agent_grad_norm:           0.0000	critic_grad_norm:         36.2817	critic_loss:               0.4222	pg_loss:                  -0.2025
q_taken_mean:              0.1172	target_mean:               0.2580	td_error_abs:              0.4969	
[INFO 16:19:01] main t_env: 60480 / 2000000
[INFO 16:19:01] main Estimated time left: 17 hours, 38 minutes, 43 seconds. Time passed: 33 minutes, 51 seconds
[INFO 16:19:12] main Recent Stats | t_env:      60480 | Episode:     1336
agent_grad_norm:           0.0000	critic_grad_norm:         28.6738	critic_loss:               0.2280	pg_loss:                  -0.4233
q_taken_mean:             -0.1237	target_mean:               0.0117	td_error_abs:              0.3634	
[INFO 16:25:02] main Recent Stats | t_env:      70560 | Episode:     1560
agent_grad_norm:           0.0000	critic_grad_norm:         43.3061	critic_loss:               0.3055	pg_loss:                  -0.6591
q_taken_mean:             -0.1948	target_mean:              -0.3211	td_error_abs:              0.4223	
[INFO 16:30:56] main t_env: 80640 / 2000000
[INFO 16:30:56] main Estimated time left: 18 hours, 54 minutes, 50 seconds. Time passed: 45 minutes, 47 seconds
[INFO 16:31:08] main Recent Stats | t_env:      80640 | Episode:     1784
agent_grad_norm:           0.0000	critic_grad_norm:         40.6402	critic_loss:               0.3337	pg_loss:                  -1.3034
q_taken_mean:             -0.6613	target_mean:              -0.8643	td_error_abs:              0.4410	
[INFO 16:36:56] main Recent Stats | t_env:      90720 | Episode:     2008
agent_grad_norm:           0.0000	critic_grad_norm:         48.5193	critic_loss:               0.3701	pg_loss:                  -2.0380
q_taken_mean:             -1.2985	target_mean:              -1.4073	td_error_abs:              0.4791	
[INFO 16:43:24] main t_env: 100800 / 2000000
[INFO 16:43:24] main Estimated time left: 19 hours, 33 minutes, 58 seconds. Time passed: 58 minutes, 14 seconds
[INFO 16:43:38] main Recent Stats | t_env:     100800 | Episode:     2232
agent_grad_norm:           0.0000	critic_grad_norm:         61.2731	critic_loss:               0.4595	pg_loss:                  -2.8743
q_taken_mean:             -2.0542	target_mean:              -2.0784	td_error_abs:              0.5494	
[INFO 16:50:31] main Recent Stats | t_env:     110880 | Episode:     2456
agent_grad_norm:           0.0000	critic_grad_norm:         73.8820	critic_loss:               0.5164	pg_loss:                  -3.6010
q_taken_mean:             -3.0004	target_mean:              -2.9146	td_error_abs:              0.6057	
[INFO 16:57:08] main t_env: 120960 / 2000000
[INFO 16:57:08] main Estimated time left: 21 hours, 19 minutes, 30 seconds. Time passed: 1 hours, 11 minutes, 58 seconds
[INFO 16:57:22] main Recent Stats | t_env:     120960 | Episode:     2680
agent_grad_norm:           0.0000	critic_grad_norm:         69.5147	critic_loss:               0.4339	pg_loss:                  -4.4951
q_taken_mean:             -3.8943	target_mean:              -3.7292	td_error_abs:              0.5478	
[INFO 17:04:22] main Recent Stats | t_env:     131040 | Episode:     2904
agent_grad_norm:           0.0000	critic_grad_norm:         65.2591	critic_loss:               0.3559	pg_loss:                  -5.1286
q_taken_mean:             -4.5319	target_mean:              -4.3803	td_error_abs:              0.4813	
[INFO 17:11:17] main t_env: 141120 / 2000000
[INFO 17:11:17] main Estimated time left: 21 hours, 44 minutes, 17 seconds. Time passed: 1 hours, 26 minutes, 7 seconds
[INFO 17:11:29] main Recent Stats | t_env:     141120 | Episode:     3128
agent_grad_norm:           0.0000	critic_grad_norm:         58.8050	critic_loss:               0.3109	pg_loss:                  -5.6749
q_taken_mean:             -5.0897	target_mean:              -5.0218	td_error_abs:              0.4390	
[INFO 17:18:35] main Recent Stats | t_env:     151200 | Episode:     3352
agent_grad_norm:           0.0000	critic_grad_norm:         48.2272	critic_loss:               0.2258	pg_loss:                  -5.9535
q_taken_mean:             -5.5718	target_mean:              -5.5268	td_error_abs:              0.3760	
[INFO 17:25:40] main t_env: 161280 / 2000000
[INFO 17:25:40] main Estimated time left: 21 hours, 52 minutes, 27 seconds. Time passed: 1 hours, 40 minutes, 30 seconds
[INFO 17:25:53] main Recent Stats | t_env:     161280 | Episode:     3576
agent_grad_norm:           0.0000	critic_grad_norm:         50.5291	critic_loss:               0.2566	pg_loss:                  -6.2748
q_taken_mean:             -5.7287	target_mean:              -5.8102	td_error_abs:              0.3984	
[INFO 17:32:45] main Recent Stats | t_env:     171360 | Episode:     3800
agent_grad_norm:           0.0000	critic_grad_norm:         37.5170	critic_loss:               0.2075	pg_loss:                  -6.5890
q_taken_mean:             -6.1765	target_mean:              -6.1888	td_error_abs:              0.3508	
[INFO 17:39:49] main t_env: 181440 / 2000000
[INFO 17:39:49] main Estimated time left: 21 hours, 16 minutes, 20 seconds. Time passed: 1 hours, 54 minutes, 39 seconds
[INFO 17:40:03] main Recent Stats | t_env:     181440 | Episode:     4024
agent_grad_norm:           0.0000	critic_grad_norm:         62.9795	critic_loss:               0.2930	pg_loss:                  -6.9346
q_taken_mean:             -6.6379	target_mean:              -6.5293	td_error_abs:              0.4196	
[INFO 17:46:54] main Recent Stats | t_env:     191520 | Episode:     4248
agent_grad_norm:           0.0000	critic_grad_norm:         88.0529	critic_loss:               0.4275	pg_loss:                  -7.0522
q_taken_mean:             -6.6728	target_mean:              -6.6931	td_error_abs:              0.5142	
[INFO 17:53:58] main t_env: 201600 / 2000000
[INFO 17:53:58] main Estimated time left: 21 hours, 2 minutes, 30 seconds. Time passed: 2 hours, 8 minutes, 48 seconds
[INFO 17:54:13] main Recent Stats | t_env:     201600 | Episode:     4472
agent_grad_norm:           0.0000	critic_grad_norm:         95.8849	critic_loss:               0.4504	pg_loss:                  -7.3202
q_taken_mean:             -6.8369	target_mean:              -6.9406	td_error_abs:              0.5369	
[INFO 18:00:59] main Recent Stats | t_env:     211680 | Episode:     4696
agent_grad_norm:           0.0000	critic_grad_norm:        115.2619	critic_loss:               0.5268	pg_loss:                  -7.6288
q_taken_mean:             -7.2852	target_mean:              -7.1745	td_error_abs:              0.5881	
[INFO 18:07:15] main t_env: 221760 / 2000000
[INFO 18:07:15] main Estimated time left: 19 hours, 32 minutes, 8 seconds. Time passed: 2 hours, 22 minutes, 6 seconds
[INFO 18:07:30] main Recent Stats | t_env:     221760 | Episode:     4920
agent_grad_norm:           0.0000	critic_grad_norm:        155.2000	critic_loss:               0.7029	pg_loss:                  -7.4183
q_taken_mean:             -7.1496	target_mean:              -7.1871	td_error_abs:              0.7072	
[INFO 18:14:06] main Recent Stats | t_env:     231840 | Episode:     5144
agent_grad_norm:           0.0000	critic_grad_norm:        161.2105	critic_loss:               0.7360	pg_loss:                  -7.9711
q_taken_mean:             -7.6388	target_mean:              -7.6320	td_error_abs:              0.7309	
[INFO 18:20:35] main t_env: 241920 / 2000000
[INFO 18:20:35] main Estimated time left: 19 hours, 22 minutes, 8 seconds. Time passed: 2 hours, 35 minutes, 25 seconds
[INFO 18:20:49] main Recent Stats | t_env:     241920 | Episode:     5368
agent_grad_norm:           0.0000	critic_grad_norm:        151.4081	critic_loss:               0.6656	pg_loss:                  -8.8091
q_taken_mean:             -8.4949	target_mean:              -8.3905	td_error_abs:              0.6900	
[INFO 18:27:13] main Recent Stats | t_env:     252000 | Episode:     5592
agent_grad_norm:           0.0000	critic_grad_norm:        142.6173	critic_loss:               0.6626	pg_loss:                  -9.4935
q_taken_mean:             -9.2728	target_mean:              -9.1077	td_error_abs:              0.6870	
[INFO 18:33:46] main t_env: 262080 / 2000000
[INFO 18:33:46] main Estimated time left: 18 hours, 55 minutes, 54 seconds. Time passed: 2 hours, 48 minutes, 36 seconds
[INFO 18:33:59] main Recent Stats | t_env:     262080 | Episode:     5816
agent_grad_norm:           0.0000	critic_grad_norm:        132.7393	critic_loss:               0.6234	pg_loss:                 -10.1757
q_taken_mean:             -9.8702	target_mean:              -9.9911	td_error_abs:              0.6511	
[INFO 18:40:22] main Recent Stats | t_env:     272160 | Episode:     6040
agent_grad_norm:           0.0000	critic_grad_norm:        158.8099	critic_loss:               0.8480	pg_loss:                 -11.6963
q_taken_mean:            -11.3184	target_mean:             -10.9727	td_error_abs:              0.7402	
[INFO 18:46:45] main t_env: 282240 / 2000000
[INFO 18:46:45] main Estimated time left: 18 hours, 27 minutes, 25 seconds. Time passed: 3 hours, 1 minutes, 36 seconds
[INFO 18:46:58] main Recent Stats | t_env:     282240 | Episode:     6264
agent_grad_norm:           0.0000	critic_grad_norm:        129.1807	critic_loss:               0.7480	pg_loss:                 -11.7677
q_taken_mean:            -11.5268	target_mean:             -11.2975	td_error_abs:              0.6648	
[INFO 18:53:28] main Recent Stats | t_env:     292320 | Episode:     6488
agent_grad_norm:           0.0000	critic_grad_norm:        140.6704	critic_loss:               0.7694	pg_loss:                 -11.9677
q_taken_mean:            -12.0270	target_mean:             -11.6344	td_error_abs:              0.6812	
[INFO 19:00:02] main t_env: 302400 / 2000000
[INFO 19:00:02] main Estimated time left: 18 hours, 37 minutes, 54 seconds. Time passed: 3 hours, 14 minutes, 52 seconds
[INFO 19:00:14] main Recent Stats | t_env:     302400 | Episode:     6712
agent_grad_norm:           0.0000	critic_grad_norm:        153.2062	critic_loss:               0.8008	pg_loss:                 -12.1752
q_taken_mean:            -12.1796	target_mean:             -11.8160	td_error_abs:              0.7095	
[INFO 19:06:43] main Recent Stats | t_env:     312480 | Episode:     6936
agent_grad_norm:           0.0000	critic_grad_norm:        141.1379	critic_loss:               0.7144	pg_loss:                 -12.5242
q_taken_mean:            -12.6970	target_mean:             -12.1665	td_error_abs:              0.6572	
[INFO 19:13:33] main t_env: 322560 / 2000000
[INFO 19:13:33] main Estimated time left: 18 hours, 44 minutes, 26 seconds. Time passed: 3 hours, 28 minutes, 23 seconds
[INFO 19:13:48] main Recent Stats | t_env:     322560 | Episode:     7160
agent_grad_norm:           0.0000	critic_grad_norm:         73.2950	critic_loss:               0.3147	pg_loss:                 -12.0981
q_taken_mean:            -12.4266	target_mean:             -12.1502	td_error_abs:              0.4492	
[INFO 19:20:41] main Recent Stats | t_env:     332640 | Episode:     7384
agent_grad_norm:           0.0000	critic_grad_norm:        157.1608	critic_loss:               0.8769	pg_loss:                 -12.7411
q_taken_mean:            -13.0261	target_mean:             -12.4369	td_error_abs:              0.7076	
[INFO 19:27:29] main t_env: 342720 / 2000000
[INFO 19:27:29] main Estimated time left: 19 hours, 5 minutes, 20 seconds. Time passed: 3 hours, 42 minutes, 19 seconds
[INFO 19:27:44] main Recent Stats | t_env:     342720 | Episode:     7608
agent_grad_norm:           0.0000	critic_grad_norm:        140.6836	critic_loss:               0.8183	pg_loss:                 -13.0203
q_taken_mean:            -13.2149	target_mean:             -12.6893	td_error_abs:              0.6635	
[INFO 19:34:45] main Recent Stats | t_env:     352800 | Episode:     7832
agent_grad_norm:           0.0000	critic_grad_norm:        146.9371	critic_loss:               0.8185	pg_loss:                 -13.1928
q_taken_mean:            -13.3934	target_mean:             -12.9138	td_error_abs:              0.6603	
[INFO 19:41:45] main t_env: 362880 / 2000000
[INFO 19:41:45] main Estimated time left: 19 hours, 18 minutes, 27 seconds. Time passed: 3 hours, 56 minutes, 35 seconds
[INFO 19:42:00] main Recent Stats | t_env:     362880 | Episode:     8056
agent_grad_norm:           0.0000	critic_grad_norm:        146.0764	critic_loss:               0.9001	pg_loss:                 -13.2107
q_taken_mean:            -13.3681	target_mean:             -12.8753	td_error_abs:              0.7152	
