[INFO 21:37:52] main Experiment Parameters:
|                                      | HyperParameter Value                  |
|:-------------------------------------|:--------------------------------------|
| CM_selected_inner                    |                                       |
| NM_lane_embedding_size               | 32                                    |
| NM_phase_loss_weight                 | 0                                     |
| NM_phase_loss_with_replay            | False                                 |
| NM_road_predict_hidden               | 32                                    |
| NM_scale_by_lane_number              | False                                 |
| NM_volume_loss_weight                | 0                                     |
| agent                                |                                       |
| cityflow_log                         |                                       |
| config.accumulated_episodes          | 1                                     |
| config.action_selector               | epsilon_greedy                        |
| config.actor_input_seq_str           | o_la                                  |
| config.agent                         | n_rnn                                 |
| config.agent_output_type             | pi_logits                             |
| config.batch_size                    | 8                                     |
| config.batch_size_run                | 8                                     |
| config.buffer_cpu_only               | True                                  |
| config.buffer_size                   | 200                                   |
| config.checkpoint_path               |                                       |
| config.critic_input_seq_str          | o                                     |
| config.critic_type                   | maddpg_critic                         |
| config.epsilon_anneal_time           | 2000000                               |
| config.epsilon_finish                | 0.05                                  |
| config.epsilon_start                 | 1.0                                   |
| config.evaluate                      | False                                 |
| config.gamma                         | 0.985                                 |
| config.grad_norm_clip                | 5                                     |
| config.hidden_dim                    | 128                                   |
| config.learner                       | maddpg_learner                        |
| config.learner_log_interval          | 10000                                 |
| config.local_results_path            | /cmlscratch/anirudhs/cmarl_traffic    |
| config.log_interval                  | 10000                                 |
| config.lr                            | 0.0005                                |
| config.mac                           | maddpg_mac                            |
| config.mini_epochs                   | 1                                     |
| config.n_lambda                      | 51                                    |
| config.name                          | maddpg                                |
| config.obs_agent_id                  | True                                  |
| config.obs_individual_obs            | False                                 |
| config.obs_last_action               | False                                 |
| config.optim                         | Adam                                  |
| config.optim_alpha                   | 0.99                                  |
| config.optim_eps                     | 1e-05                                 |
| config.reg                           | 0.001                                 |
| config.run                           | maddpg_run                            |
| config.runner                        | episode                               |
| config.sampling_lambda_index         | 0                                     |
| config.save_model                    | False                                 |
| config.save_model_interval           | 1460000                               |
| config.save_probs                    | False                                 |
| config.save_replay                   | False                                 |
| config.standardise_returns           | False                                 |
| config.standardise_rewards           | True                                  |
| config.t_max                         | 2000000                               |
| config.target_update_interval_or_tau | 200                                   |
| config.test_greedy                   | True                                  |
| config.test_interval                 | 20000                                 |
| config.test_nepisode                 | 8                                     |
| config.use_cuda                      | True                                  |
| config.use_double_q                  | True                                  |
| config.use_individual_rewards        | True                                  |
| config.use_layer_norm                | False                                 |
| config.use_loss_normalization        | False                                 |
| config.use_mean_team_reward          | False                                 |
| config.use_n_lambda                  | False                                 |
| config.use_orthogonal                | False                                 |
| config.use_reward_normalization      | True                                  |
| config.use_sample_prob_weights       | True                                  |
| config.use_single_lambda_sampling    | False                                 |
| config.use_tensorboard               | False                                 |
| config.use_wandb                     | True                                  |
| config.visualize                     | False                                 |
| config.visualize_interval            | 500000                                |
| config.wandb_project_name            | ctraffic                              |
| config.whittle_hidden_dim            | 128                                   |
| constraint                           | None                                  |
| development                          | False                                 |
| enable_wandb                         | True                                  |
| env                                  | ctraffic                              |
| evaluate_interval                    | 10                                    |
| evaluate_round                       | 10                                    |
| feature_hidden_size                  | 512                                   |
| fixed_time                           | 30                                    |
| gamma                                | 0.99                                  |
| gammas                               | 0.99                                  |
| gpu_to_use                           |                                       |
| green_skip_penalty                   | 0.2                                   |
| green_time_penalty                   | 0.2                                   |
| learning_rate                        | 0.0001                                |
| log_folder                           | logs/                                 |
| log_interval                         | 100                                   |
| main                                 |                                       |
| mode                                 | train                                 |
| model                                |                                       |
| model_save_path                      |                                       |
| multi_agent                          |                                       |
| n_frames                             | 1000000                               |
| n_steps                              | 5                                     |
| name                                 | maddpg                                |
| no_cuda                              | False                                 |
| phase_skip_penalty                   | 0.2                                   |
| preload_model_file                   |                                       |
| render_steps                         | -1                                    |
| results_path                         | /cmlscratch/anirudhs/ctraffic/results |
| save_interval                        | 0                                     |
| seed                                 | 994685696                             |
| simulate_time                        | 360                                   |
| target_reward                        | 1e+100                                |
| tensorboardx_comment                 |                                       |
| test_round                           | 0                                     |
| threads                              | 128                                   |
| use_cuda                             | True                                  |
| wandb_api_key                        |                                       |
| wandb_entity_name                    | anirudh-satheesh                      |
| wandb_project_name                   | ctraffic                              |
| wandb_sync_mode                      | online                                |
| work_folder                          | ./                                    |
| wrapper_model                        |                                       |
[INFO 21:37:53] main MDP Components:
|                    | vshape   | group   | dtype         |
|:-------------------|:---------|:--------|:--------------|
| actions            | (1,)     | agents  | torch.int64   |
| actions_onehot     | (8,)     | agents  | torch.float32 |
| avail_actions      | (8,)     | agents  | torch.int32   |
| filled             | (1,)     |         | torch.int64   |
| individual_rewards | (1,)     | agents  |               |
| mean_action        | (8,)     | agents  | torch.float32 |
| obs                | 204      | agents  |               |
| probs              | (8,)     | agents  | torch.float32 |
| reward             | (1,)     |         |               |
| state              | 3264.0   |         |               |
| terminated         | (1,)     |         | torch.uint8   |
| total_reward       | (1,)     |         |               |
Input Shape: 3296
[INFO 21:38:01] main Beginning training for 2000000 timesteps
[INFO 21:43:50] main Recent Stats | t_env:      10080 | Episode:      216
agent_grad_norm:           0.0013	critic_grad_norm:         32.1390	critic_loss:               1.0116	pg_loss:                  -0.9258
q_taken_mean:             -0.2367	target_mean:              -0.2335	td_error_abs:              0.8042	
[INFO 21:49:45] main t_env: 20160 / 2000000
[INFO 21:49:45] main Estimated time left: 19 hours, 11 minutes, 30 seconds. Time passed: 11 minutes, 43 seconds
new test result : -544.1708552499999
[INFO 21:49:55] main Recent Stats | t_env:      20160 | Episode:      440
agent_grad_norm:           0.0007	critic_grad_norm:         21.9512	critic_loss:               0.6152	pg_loss:                  -0.7222
q_taken_mean:             -0.3177	target_mean:              -0.2966	td_error_abs:              0.5853	
[INFO 21:55:53] main Recent Stats | t_env:      30240 | Episode:      664
agent_grad_norm:           0.0003	critic_grad_norm:         20.8266	critic_loss:               0.5512	pg_loss:                  -0.6965
q_taken_mean:             -0.2047	target_mean:              -0.2254	td_error_abs:              0.5500	
[INFO 22:01:58] main t_env: 40320 / 2000000
[INFO 22:01:58] main Estimated time left: 19 hours, 49 minutes, 0 seconds. Time passed: 23 minutes, 57 seconds
[INFO 22:02:11] main Recent Stats | t_env:      40320 | Episode:      888
agent_grad_norm:           0.0000	critic_grad_norm:         27.1108	critic_loss:               0.4732	pg_loss:                  -0.9355
q_taken_mean:             -0.4439	target_mean:              -0.3680	td_error_abs:              0.5130	
[INFO 22:08:06] main Recent Stats | t_env:      50400 | Episode:     1112
agent_grad_norm:           0.0000	critic_grad_norm:         28.7567	critic_loss:               0.4035	pg_loss:                  -1.0724
q_taken_mean:             -0.6193	target_mean:              -0.5030	td_error_abs:              0.4693	
[INFO 22:14:19] main t_env: 60480 / 2000000
[INFO 22:14:19] main Estimated time left: 19 hours, 46 minutes, 43 seconds. Time passed: 36 minutes, 17 seconds
[INFO 22:14:31] main Recent Stats | t_env:      60480 | Episode:     1336
agent_grad_norm:           0.0000	critic_grad_norm:         27.9256	critic_loss:               0.2419	pg_loss:                  -1.1974
q_taken_mean:             -0.8112	target_mean:              -0.6430	td_error_abs:              0.3719	
[INFO 22:20:39] main Recent Stats | t_env:      70560 | Episode:     1560
agent_grad_norm:           0.0000	critic_grad_norm:         51.2697	critic_loss:               0.3691	pg_loss:                  -1.4122
q_taken_mean:             -0.8796	target_mean:              -0.8865	td_error_abs:              0.4700	
[INFO 22:26:59] main t_env: 80640 / 2000000
[INFO 22:26:59] main Estimated time left: 20 hours, 5 minutes, 59 seconds. Time passed: 48 minutes, 57 seconds
new test result : -540.3298505
[INFO 22:27:11] main Recent Stats | t_env:      80640 | Episode:     1784
agent_grad_norm:           0.0000	critic_grad_norm:         81.9537	critic_loss:               0.5384	pg_loss:                  -1.7923
q_taken_mean:             -1.1547	target_mean:              -1.3154	td_error_abs:              0.5809	
[INFO 22:33:21] main Recent Stats | t_env:      90720 | Episode:     2008
agent_grad_norm:           0.0000	critic_grad_norm:         77.3387	critic_loss:               0.5210	pg_loss:                  -2.0696
q_taken_mean:             -1.3926	target_mean:              -1.6446	td_error_abs:              0.5590	
[INFO 22:39:26] main t_env: 100800 / 2000000
[INFO 22:39:26] main Estimated time left: 19 hours, 32 minutes, 55 seconds. Time passed: 1 hours, 1 minutes, 24 seconds
[INFO 22:39:37] main Recent Stats | t_env:     100800 | Episode:     2232
agent_grad_norm:           0.0000	critic_grad_norm:         79.1338	critic_loss:               0.5699	pg_loss:                  -2.5342
q_taken_mean:             -1.8120	target_mean:              -2.0893	td_error_abs:              0.5974	
[INFO 22:45:53] main Recent Stats | t_env:     110880 | Episode:     2456
agent_grad_norm:           0.0000	critic_grad_norm:         80.8378	critic_loss:               0.6156	pg_loss:                  -3.1031
q_taken_mean:             -2.2640	target_mean:              -2.6167	td_error_abs:              0.6298	
[INFO 22:52:01] main t_env: 120960 / 2000000
[INFO 22:52:01] main Estimated time left: 19 hours, 32 minutes, 57 seconds. Time passed: 1 hours, 13 minutes, 59 seconds
[INFO 22:52:12] main Recent Stats | t_env:     120960 | Episode:     2680
agent_grad_norm:           0.0000	critic_grad_norm:         63.7541	critic_loss:               0.4917	pg_loss:                  -3.5455
q_taken_mean:             -2.7835	target_mean:              -2.9928	td_error_abs:              0.5373	
[INFO 22:58:13] main Recent Stats | t_env:     131040 | Episode:     2904
agent_grad_norm:           0.0000	critic_grad_norm:         46.7362	critic_loss:               0.3064	pg_loss:                  -4.1098
q_taken_mean:             -3.4825	target_mean:              -3.6012	td_error_abs:              0.4314	
[INFO 23:04:02] main t_env: 141120 / 2000000
[INFO 23:04:02] main Estimated time left: 18 hours, 27 minutes, 42 seconds. Time passed: 1 hours, 26 minutes, 0 seconds
new test result : -532.4453612500001
[INFO 23:04:13] main Recent Stats | t_env:     141120 | Episode:     3128
agent_grad_norm:           0.0000	critic_grad_norm:         61.2905	critic_loss:               0.3448	pg_loss:                  -4.4024
q_taken_mean:             -3.8593	target_mean:              -4.0505	td_error_abs:              0.4748	
[INFO 23:10:21] main Recent Stats | t_env:     151200 | Episode:     3352
agent_grad_norm:           0.0000	critic_grad_norm:         54.7419	critic_loss:               0.2936	pg_loss:                  -4.8069
q_taken_mean:             -4.3168	target_mean:              -4.5272	td_error_abs:              0.4284	
[INFO 23:16:37] main t_env: 161280 / 2000000
[INFO 23:16:37] main Estimated time left: 19 hours, 8 minutes, 32 seconds. Time passed: 1 hours, 38 minutes, 36 seconds
[INFO 23:16:48] main Recent Stats | t_env:     161280 | Episode:     3576
agent_grad_norm:           0.0000	critic_grad_norm:         72.4033	critic_loss:               0.3677	pg_loss:                  -5.4978
q_taken_mean:             -5.0980	target_mean:              -5.1427	td_error_abs:              0.4758	
[INFO 23:23:01] main Recent Stats | t_env:     171360 | Episode:     3800
agent_grad_norm:           0.0000	critic_grad_norm:         76.5133	critic_loss:               0.3846	pg_loss:                  -6.3869
q_taken_mean:             -6.1079	target_mean:              -6.0621	td_error_abs:              0.4859	
[INFO 23:29:16] main t_env: 181440 / 2000000
[INFO 23:29:16] main Estimated time left: 19 hours, 1 minutes, 23 seconds. Time passed: 1 hours, 51 minutes, 15 seconds
[INFO 23:29:29] main Recent Stats | t_env:     181440 | Episode:     4024
agent_grad_norm:           0.0000	critic_grad_norm:         61.0899	critic_loss:               0.3469	pg_loss:                  -6.9696
q_taken_mean:             -6.8620	target_mean:              -6.7163	td_error_abs:              0.4448	
[INFO 23:35:52] main Recent Stats | t_env:     191520 | Episode:     4248
agent_grad_norm:           0.0000	critic_grad_norm:         47.8910	critic_loss:               0.3276	pg_loss:                  -7.7037
q_taken_mean:             -7.7415	target_mean:              -7.4880	td_error_abs:              0.4160	
[INFO 23:42:09] main t_env: 201600 / 2000000
[INFO 23:42:09] main Estimated time left: 19 hours, 8 minutes, 30 seconds. Time passed: 2 hours, 4 minutes, 7 seconds
[INFO 23:42:22] main Recent Stats | t_env:     201600 | Episode:     4472
agent_grad_norm:           0.0000	critic_grad_norm:         66.1966	critic_loss:               0.3784	pg_loss:                  -8.1280
q_taken_mean:             -8.1565	target_mean:              -7.8049	td_error_abs:              0.4671	
[INFO 23:48:41] main Recent Stats | t_env:     211680 | Episode:     4696
agent_grad_norm:           0.0000	critic_grad_norm:         51.0459	critic_loss:               0.2449	pg_loss:                  -8.2272
q_taken_mean:             -8.3222	target_mean:              -8.0611	td_error_abs:              0.3830	
[INFO 23:54:59] main t_env: 221760 / 2000000
[INFO 23:54:59] main Estimated time left: 18 hours, 52 minutes, 7 seconds. Time passed: 2 hours, 16 minutes, 57 seconds
[INFO 23:55:12] main Recent Stats | t_env:     221760 | Episode:     4920
agent_grad_norm:           0.0000	critic_grad_norm:         44.5152	critic_loss:               0.2029	pg_loss:                  -8.2569
q_taken_mean:             -8.4263	target_mean:              -8.1930	td_error_abs:              0.3455	
[INFO 00:01:37] main Recent Stats | t_env:     231840 | Episode:     5144
agent_grad_norm:           0.0000	critic_grad_norm:         72.8884	critic_loss:               0.2750	pg_loss:                  -8.4723
q_taken_mean:             -8.5874	target_mean:              -8.2316	td_error_abs:              0.4170	
[INFO 00:07:56] main t_env: 241920 / 2000000
[INFO 00:07:56] main Estimated time left: 18 hours, 49 minutes, 22 seconds. Time passed: 2 hours, 29 minutes, 54 seconds
[INFO 00:08:09] main Recent Stats | t_env:     241920 | Episode:     5368
agent_grad_norm:           0.0000	critic_grad_norm:         76.7667	critic_loss:               0.2780	pg_loss:                  -8.9704
q_taken_mean:             -8.9585	target_mean:              -8.6318	td_error_abs:              0.4252	
[INFO 00:14:32] main Recent Stats | t_env:     252000 | Episode:     5592
agent_grad_norm:           0.0000	critic_grad_norm:         64.9181	critic_loss:               0.2378	pg_loss:                  -9.6565
q_taken_mean:             -9.7432	target_mean:              -9.4851	td_error_abs:              0.3879	
[INFO 00:20:43] main t_env: 262080 / 2000000
[INFO 00:20:43] main Estimated time left: 18 hours, 22 minutes, 7 seconds. Time passed: 2 hours, 42 minutes, 41 seconds
[INFO 00:20:56] main Recent Stats | t_env:     262080 | Episode:     5816
agent_grad_norm:           0.0000	critic_grad_norm:         67.1282	critic_loss:               0.2637	pg_loss:                 -10.1015
q_taken_mean:            -10.1740	target_mean:             -10.0102	td_error_abs:              0.4031	
[INFO 00:27:13] main Recent Stats | t_env:     272160 | Episode:     6040
agent_grad_norm:           0.0000	critic_grad_norm:         89.8632	critic_loss:               0.3511	pg_loss:                 -10.6783
q_taken_mean:            -10.5961	target_mean:             -10.5794	td_error_abs:              0.4762	
[INFO 00:33:34] main t_env: 282240 / 2000000
[INFO 00:33:34] main Estimated time left: 18 hours, 15 minutes, 10 seconds. Time passed: 2 hours, 55 minutes, 33 seconds
[INFO 00:33:46] main Recent Stats | t_env:     282240 | Episode:     6264
agent_grad_norm:           0.0000	critic_grad_norm:         83.7213	critic_loss:               0.3120	pg_loss:                 -10.9134
q_taken_mean:            -10.9974	target_mean:             -11.0123	td_error_abs:              0.4437	
[INFO 00:40:10] main Recent Stats | t_env:     292320 | Episode:     6488
agent_grad_norm:           0.0000	critic_grad_norm:        122.8927	critic_loss:               0.4595	pg_loss:                 -11.3407
q_taken_mean:            -11.5307	target_mean:             -11.3375	td_error_abs:              0.5467	
[INFO 00:46:27] main t_env: 302400 / 2000000
[INFO 00:46:27] main Estimated time left: 18 hours, 4 minutes, 12 seconds. Time passed: 3 hours, 8 minutes, 25 seconds
new test result : -515.00405
[INFO 00:46:40] main Recent Stats | t_env:     302400 | Episode:     6712
agent_grad_norm:           0.0000	critic_grad_norm:        138.0419	critic_loss:               0.5179	pg_loss:                 -11.3042
q_taken_mean:            -11.5937	target_mean:             -11.3236	td_error_abs:              0.5895	
