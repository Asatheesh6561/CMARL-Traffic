[INFO 11:49:59] main Experiment Parameters:
|                                      | HyperParameter Value                                              |
|:-------------------------------------|:------------------------------------------------------------------|
| CM_selected_inner                    |                                                                   |
| NM_lane_embedding_size               | 32                                                                |
| NM_phase_loss_weight                 | 0                                                                 |
| NM_phase_loss_with_replay            | False                                                             |
| NM_road_predict_hidden               | 32                                                                |
| NM_scale_by_lane_number              | False                                                             |
| NM_volume_loss_weight                | 0                                                                 |
| agent                                |                                                                   |
| cityflow_log                         |                                                                   |
| config.accumulated_episodes          | 1                                                                 |
| config.action_selector               | epsilon_greedy                                                    |
| config.actor_input_seq_str           | o_la                                                              |
| config.agent                         | n_rnn                                                             |
| config.agent_output_type             | pi_logits                                                         |
| config.batch_size                    | 8                                                                 |
| config.batch_size_run                | 8                                                                 |
| config.buffer_cpu_only               | True                                                              |
| config.buffer_size                   | 200                                                               |
| config.checkpoint_path               |                                                                   |
| config.critic_input_seq_str          | o                                                                 |
| config.critic_type                   | maddpg_critic                                                     |
| config.epsilon_anneal_time           | 500000                                                            |
| config.epsilon_finish                | 0.05                                                              |
| config.epsilon_start                 | 1.0                                                               |
| config.evaluate                      | False                                                             |
| config.gamma                         | 0.985                                                             |
| config.grad_norm_clip                | 5                                                                 |
| config.hidden_dim                    | 128                                                               |
| config.learner                       | maddpg_learner                                                    |
| config.learner_log_interval          | 10000                                                             |
| config.local_results_path            | /cmlscratch/anirudhs/cmarl_traffic                                |
| config.log_interval                  | 10000                                                             |
| config.lr                            | 0.0005                                                            |
| config.mac                           | maddpg_mac                                                        |
| config.mini_epochs                   | 1                                                                 |
| config.n_lambda                      | 51                                                                |
| config.name                          | maddpg                                                            |
| config.obs_agent_id                  | True                                                              |
| config.obs_individual_obs            | False                                                             |
| config.obs_last_action               | False                                                             |
| config.optim                         | Adam                                                              |
| config.optim_alpha                   | 0.99                                                              |
| config.optim_eps                     | 1e-05                                                             |
| config.reg                           | 0.001                                                             |
| config.run                           | maddpg_run                                                        |
| config.runner                        | episode                                                           |
| config.sampling_lambda_index         | 0                                                                 |
| config.save_model                    | False                                                             |
| config.save_model_interval           | 1460000                                                           |
| config.save_probs                    | False                                                             |
| config.save_replay                   | False                                                             |
| config.standardise_returns           | False                                                             |
| config.standardise_rewards           | True                                                              |
| config.t_max                         | 500000                                                            |
| config.target_update_interval_or_tau | 200                                                               |
| config.test_greedy                   | True                                                              |
| config.test_interval                 | 5000                                                              |
| config.test_nepisode                 | 8                                                                 |
| config.use_cuda                      | True                                                              |
| config.use_double_q                  | True                                                              |
| config.use_individual_rewards        | True                                                              |
| config.use_layer_norm                | False                                                             |
| config.use_loss_normalization        | False                                                             |
| config.use_mean_team_reward          | False                                                             |
| config.use_n_lambda                  | False                                                             |
| config.use_orthogonal                | False                                                             |
| config.use_reward_normalization      | True                                                              |
| config.use_sample_prob_weights       | True                                                              |
| config.use_single_lambda_sampling    | False                                                             |
| config.use_tensorboard               | False                                                             |
| config.use_wandb                     | True                                                              |
| config.visualize                     | False                                                             |
| config.visualize_interval            | 500000                                                            |
| config.wandb_project_name            | ctraffic                                                          |
| config.whittle_hidden_dim            | 128                                                               |
| constraint                           | green_skip                                                        |
| development                          | False                                                             |
| enable_wandb                         | True                                                              |
| env                                  | ctraffic                                                          |
| evaluate_interval                    | 10                                                                |
| evaluate_round                       | 10                                                                |
| feature_hidden_size                  | 512                                                               |
| fixed_time                           | 30                                                                |
| gamma                                | 0.99                                                              |
| gammas                               | 0.99                                                              |
| gpu_to_use                           |                                                                   |
| green_skip_penalty                   | 0.2                                                               |
| green_time_penalty                   | 0.2                                                               |
| learning_rate                        | 0.0001                                                            |
| log_folder                           | logs/                                                             |
| log_interval                         | 100                                                               |
| main                                 |                                                                   |
| mode                                 | train                                                             |
| model                                |                                                                   |
| model_save_path                      |                                                                   |
| multi_agent                          |                                                                   |
| n_frames                             | 1000000                                                           |
| n_steps                              | 5                                                                 |
| name                                 | maddpg                                                            |
| no_cuda                              | False                                                             |
| phase_skip_penalty                   | 0.2                                                               |
| preload_model_file                   |                                                                   |
| render_steps                         | -1                                                                |
| results_file                         | /cmlscratch/anirudhs/ctraffic/results/maddpg_JN_green_skip_45.pkl |
| results_path                         | /cmlscratch/anirudhs/ctraffic/results                             |
| save_interval                        | 0                                                                 |
| seed                                 | 45                                                                |
| simulate_time                        | 360                                                               |
| target_reward                        | 1e+100                                                            |
| tensorboardx_comment                 |                                                                   |
| test_round                           | 0                                                                 |
| threads                              | 16                                                                |
| use_cuda                             | True                                                              |
| wandb_api_key                        |                                                                   |
| wandb_entity_name                    | anirudh-satheesh                                                  |
| wandb_project_name                   | ctraffic                                                          |
| wandb_sync_mode                      | online                                                            |
| work_folder                          | ./                                                                |
| wrapper_model                        |                                                                   |
[INFO 11:50:00] main MDP Components:
|                    | vshape   | group   | dtype         |
|:-------------------|:---------|:--------|:--------------|
| actions            | (1,)     | agents  | torch.int64   |
| actions_onehot     | (8,)     | agents  | torch.float32 |
| avail_actions      | (8,)     | agents  | torch.int32   |
| filled             | (1,)     |         | torch.int64   |
| individual_rewards | (1,)     | agents  |               |
| mean_action        | (8,)     | agents  | torch.float32 |
| obs                | 204      | agents  |               |
| probs              | (8,)     | agents  | torch.float32 |
| reward             | (1,)     |         |               |
| state              | 2448.0   |         |               |
| terminated         | (1,)     |         | torch.uint8   |
| total_reward       | (1,)     |         |               |
Input Shape: 2472
[INFO 11:50:05] main Beginning training for 500000 timesteps
[INFO 11:53:43] main t_env: 5040 / 500000
[INFO 11:53:43] main Estimated time left: 5 hours, 55 minutes, 55 seconds. Time passed: 3 minutes, 37 seconds
new test result : -1236.1891840277774
[INFO 11:57:47] main t_env: 10080 / 500000
[INFO 11:57:47] main Estimated time left: 6 hours, 36 minutes, 5 seconds. Time passed: 7 minutes, 41 seconds
[INFO 11:58:03] main Recent Stats | t_env:      10080 | Episode:      216
agent_grad_norm:           0.0022	critic_grad_norm:         45.6897	critic_loss:               1.0013	pg_loss:                  -0.5858
q_taken_mean:              0.0168	target_mean:               0.0129	td_error_abs:              0.8535	
[INFO 12:01:56] main t_env: 15120 / 500000
[INFO 12:01:56] main Estimated time left: 6 hours, 38 minutes, 22 seconds. Time passed: 11 minutes, 50 seconds
[INFO 12:06:03] main t_env: 20160 / 500000
[INFO 12:06:04] main Estimated time left: 6 hours, 33 minutes, 27 seconds. Time passed: 15 minutes, 58 seconds
[INFO 12:06:20] main Recent Stats | t_env:      20160 | Episode:      440
agent_grad_norm:           0.0012	critic_grad_norm:         41.5973	critic_loss:               0.6450	pg_loss:                  -0.3743
q_taken_mean:             -0.1654	target_mean:              -0.0220	td_error_abs:              0.6505	
[INFO 12:10:07] main t_env: 25200 / 500000
[INFO 12:10:07] main Estimated time left: 6 hours, 22 minutes, 36 seconds. Time passed: 20 minutes, 2 seconds
[INFO 12:14:07] main t_env: 30240 / 500000
[INFO 12:14:07] main Estimated time left: 6 hours, 13 minutes, 0 seconds. Time passed: 24 minutes, 2 seconds
new test result : -1218.8434736388888
[INFO 12:14:22] main Recent Stats | t_env:      30240 | Episode:      664
agent_grad_norm:           0.0005	critic_grad_norm:         34.3532	critic_loss:               0.4892	pg_loss:                  -0.3528
q_taken_mean:             -0.0563	target_mean:              -0.0241	td_error_abs:              0.5433	
[INFO 12:18:06] main t_env: 35280 / 500000
[INFO 12:18:06] main Estimated time left: 6 hours, 7 minutes, 1 seconds. Time passed: 28 minutes, 0 seconds
[INFO 12:22:02] main t_env: 40320 / 500000
[INFO 12:22:02] main Estimated time left: 5 hours, 58 minutes, 13 seconds. Time passed: 31 minutes, 56 seconds
[INFO 12:22:17] main Recent Stats | t_env:      40320 | Episode:      888
agent_grad_norm:           0.0001	critic_grad_norm:         29.0694	critic_loss:               0.3995	pg_loss:                  -0.4001
q_taken_mean:             -0.0385	target_mean:              -0.0182	td_error_abs:              0.4750	
[INFO 12:26:00] main t_env: 45360 / 500000
[INFO 12:26:00] main Estimated time left: 5 hours, 58 minutes, 3 seconds. Time passed: 35 minutes, 54 seconds
[INFO 12:30:00] main t_env: 50400 / 500000
[INFO 12:30:00] main Estimated time left: 5 hours, 57 minutes, 15 seconds. Time passed: 39 minutes, 55 seconds
[INFO 12:30:16] main Recent Stats | t_env:      50400 | Episode:     1112
agent_grad_norm:           0.0000	critic_grad_norm:         31.8133	critic_loss:               0.3551	pg_loss:                  -0.3953
q_taken_mean:              0.0280	target_mean:              -0.0096	td_error_abs:              0.4514	
[INFO 12:34:02] main t_env: 55440 / 500000
[INFO 12:34:02] main Estimated time left: 5 hours, 54 minutes, 55 seconds. Time passed: 43 minutes, 56 seconds
[INFO 12:38:07] main t_env: 60480 / 500000
[INFO 12:38:07] main Estimated time left: 5 hours, 56 minutes, 16 seconds. Time passed: 48 minutes, 1 seconds
[INFO 12:38:22] main Recent Stats | t_env:      60480 | Episode:     1336
agent_grad_norm:           0.0000	critic_grad_norm:         26.6662	critic_loss:               0.1880	pg_loss:                  -0.4530
q_taken_mean:             -0.1917	target_mean:              -0.1827	td_error_abs:              0.3452	
[INFO 12:42:10] main t_env: 65520 / 500000
[INFO 12:42:10] main Estimated time left: 5 hours, 49 minutes, 34 seconds. Time passed: 52 minutes, 4 seconds
[INFO 12:46:13] main t_env: 70560 / 500000
[INFO 12:46:13] main Estimated time left: 5 hours, 44 minutes, 44 seconds. Time passed: 56 minutes, 7 seconds
new test result : -1217.996305166667
[INFO 12:46:28] main Recent Stats | t_env:      70560 | Episode:     1560
agent_grad_norm:           0.0000	critic_grad_norm:         31.9128	critic_loss:               0.1882	pg_loss:                  -0.5496
q_taken_mean:             -0.1886	target_mean:              -0.3242	td_error_abs:              0.3509	
[INFO 12:50:16] main t_env: 75600 / 500000
[INFO 12:50:16] main Estimated time left: 5 hours, 41 minutes, 21 seconds. Time passed: 1 hours, 10 seconds
[INFO 12:54:20] main t_env: 80640 / 500000
[INFO 12:54:20] main Estimated time left: 5 hours, 38 minutes, 4 seconds. Time passed: 1 hours, 4 minutes, 14 seconds
[INFO 12:54:35] main Recent Stats | t_env:      80640 | Episode:     1784
agent_grad_norm:           0.0000	critic_grad_norm:         41.4898	critic_loss:               0.2488	pg_loss:                  -0.8612
q_taken_mean:             -0.3901	target_mean:              -0.5441	td_error_abs:              0.3992	
[INFO 12:58:16] main t_env: 85680 / 500000
[INFO 12:58:16] main Estimated time left: 5 hours, 23 minutes, 29 seconds. Time passed: 1 hours, 8 minutes, 10 seconds
[INFO 13:02:16] main t_env: 90720 / 500000
[INFO 13:02:16] main Estimated time left: 5 hours, 25 minutes, 19 seconds. Time passed: 1 hours, 12 minutes, 11 seconds
new test result : -1215.3549121111116
[INFO 13:02:32] main Recent Stats | t_env:      90720 | Episode:     2008
agent_grad_norm:           0.0000	critic_grad_norm:         40.4453	critic_loss:               0.2467	pg_loss:                  -1.1142
q_taken_mean:             -0.6700	target_mean:              -0.8188	td_error_abs:              0.3996	
[INFO 13:06:18] main t_env: 95760 / 500000
[INFO 13:06:18] main Estimated time left: 5 hours, 23 minutes, 23 seconds. Time passed: 1 hours, 16 minutes, 13 seconds
new test result : -1205.6425320555556
[INFO 13:10:22] main t_env: 100800 / 500000
[INFO 13:10:22] main Estimated time left: 5 hours, 21 minutes, 15 seconds. Time passed: 1 hours, 20 minutes, 16 seconds
[INFO 13:10:37] main Recent Stats | t_env:     100800 | Episode:     2232
agent_grad_norm:           0.0000	critic_grad_norm:         46.1564	critic_loss:               0.2782	pg_loss:                  -1.8520
q_taken_mean:             -1.3951	target_mean:              -1.4093	td_error_abs:              0.4240	
[INFO 13:14:25] main t_env: 105840 / 500000
[INFO 13:14:25] main Estimated time left: 5 hours, 16 minutes, 49 seconds. Time passed: 1 hours, 24 minutes, 19 seconds
[INFO 13:18:29] main t_env: 110880 / 500000
[INFO 13:18:29] main Estimated time left: 5 hours, 13 minutes, 51 seconds. Time passed: 1 hours, 28 minutes, 23 seconds
[INFO 13:18:45] main Recent Stats | t_env:     110880 | Episode:     2456
agent_grad_norm:           0.0000	critic_grad_norm:         66.1035	critic_loss:               0.3723	pg_loss:                  -2.5251
q_taken_mean:             -1.9508	target_mean:              -1.8569	td_error_abs:              0.5060	
[INFO 13:22:34] main t_env: 115920 / 500000
[INFO 13:22:34] main Estimated time left: 5 hours, 12 minutes, 1 seconds. Time passed: 1 hours, 32 minutes, 29 seconds
[INFO 13:26:40] main t_env: 120960 / 500000
[INFO 13:26:40] main Estimated time left: 5 hours, 7 minutes, 51 seconds. Time passed: 1 hours, 36 minutes, 34 seconds
[INFO 13:26:56] main Recent Stats | t_env:     120960 | Episode:     2680
agent_grad_norm:           0.0000	critic_grad_norm:         72.5437	critic_loss:               0.4077	pg_loss:                  -3.1486
q_taken_mean:             -2.5884	target_mean:              -2.5146	td_error_abs:              0.5305	
[INFO 13:30:45] main t_env: 126000 / 500000
[INFO 13:30:45] main Estimated time left: 5 hours, 2 minutes, 42 seconds. Time passed: 1 hours, 40 minutes, 39 seconds
[INFO 13:34:47] main t_env: 131040 / 500000
[INFO 13:34:47] main Estimated time left: 4 hours, 55 minutes, 31 seconds. Time passed: 1 hours, 44 minutes, 41 seconds
[INFO 13:35:03] main Recent Stats | t_env:     131040 | Episode:     2904
agent_grad_norm:           0.0000	critic_grad_norm:         82.7779	critic_loss:               0.4413	pg_loss:                  -4.0423
q_taken_mean:             -3.6140	target_mean:              -3.3339	td_error_abs:              0.5611	
[INFO 13:38:52] main t_env: 136080 / 500000
[INFO 13:38:52] main Estimated time left: 4 hours, 55 minutes, 22 seconds. Time passed: 1 hours, 48 minutes, 47 seconds
[INFO 13:42:58] main t_env: 141120 / 500000
[INFO 13:42:58] main Estimated time left: 4 hours, 51 minutes, 3 seconds. Time passed: 1 hours, 52 minutes, 52 seconds
[INFO 13:43:13] main Recent Stats | t_env:     141120 | Episode:     3128
agent_grad_norm:           0.0000	critic_grad_norm:         95.7644	critic_loss:               0.4889	pg_loss:                  -5.0863
q_taken_mean:             -4.6676	target_mean:              -4.2812	td_error_abs:              0.6084	
[INFO 13:46:59] main t_env: 146160 / 500000
[INFO 13:46:59] main Estimated time left: 4 hours, 42 minutes, 42 seconds. Time passed: 1 hours, 56 minutes, 54 seconds
[INFO 13:50:58] main t_env: 151200 / 500000
[INFO 13:50:58] main Estimated time left: 4 hours, 34 minutes, 57 seconds. Time passed: 2 hours, 52 seconds
[INFO 13:51:13] main Recent Stats | t_env:     151200 | Episode:     3352
agent_grad_norm:           0.0000	critic_grad_norm:         90.1902	critic_loss:               0.4688	pg_loss:                  -5.7150
q_taken_mean:             -5.3686	target_mean:              -4.9907	td_error_abs:              0.5901	
[INFO 13:54:59] main t_env: 156240 / 500000
[INFO 13:54:59] main Estimated time left: 4 hours, 34 minutes, 40 seconds. Time passed: 2 hours, 4 minutes, 54 seconds
[INFO 13:58:54] main t_env: 161280 / 500000
[INFO 13:58:54] main Estimated time left: 4 hours, 23 minutes, 13 seconds. Time passed: 2 hours, 8 minutes, 49 seconds
[INFO 13:59:10] main Recent Stats | t_env:     161280 | Episode:     3576
agent_grad_norm:           0.0000	critic_grad_norm:         72.2812	critic_loss:               0.3977	pg_loss:                  -6.5809
q_taken_mean:             -6.2236	target_mean:              -5.9536	td_error_abs:              0.5300	
[INFO 14:02:53] main t_env: 166320 / 500000
[INFO 14:02:53] main Estimated time left: 4 hours, 23 minutes, 9 seconds. Time passed: 2 hours, 12 minutes, 47 seconds
[INFO 14:06:53] main t_env: 171360 / 500000
[INFO 14:06:53] main Estimated time left: 4 hours, 20 minutes, 45 seconds. Time passed: 2 hours, 16 minutes, 47 seconds
[INFO 14:07:08] main Recent Stats | t_env:     171360 | Episode:     3800
agent_grad_norm:           0.0000	critic_grad_norm:         79.1637	critic_loss:               0.4153	pg_loss:                  -7.5999
q_taken_mean:             -7.2819	target_mean:              -6.7803	td_error_abs:              0.5398	
[INFO 14:10:51] main t_env: 176400 / 500000
[INFO 14:10:51] main Estimated time left: 4 hours, 15 minutes, 19 seconds. Time passed: 2 hours, 20 minutes, 46 seconds
[INFO 14:14:49] main t_env: 181440 / 500000
[INFO 14:14:49] main Estimated time left: 4 hours, 10 minutes, 38 seconds. Time passed: 2 hours, 24 minutes, 44 seconds
[INFO 14:15:05] main Recent Stats | t_env:     181440 | Episode:     4024
agent_grad_norm:           0.0000	critic_grad_norm:         67.0057	critic_loss:               0.3437	pg_loss:                  -8.0914
q_taken_mean:             -7.6860	target_mean:              -7.3868	td_error_abs:              0.4815	
[INFO 14:18:49] main t_env: 186480 / 500000
[INFO 14:18:49] main Estimated time left: 4 hours, 8 minutes, 57 seconds. Time passed: 2 hours, 28 minutes, 44 seconds
[INFO 14:22:49] main t_env: 191520 / 500000
[INFO 14:22:49] main Estimated time left: 4 hours, 4 minutes, 13 seconds. Time passed: 2 hours, 32 minutes, 43 seconds
[INFO 14:23:04] main Recent Stats | t_env:     191520 | Episode:     4248
agent_grad_norm:           0.0000	critic_grad_norm:         70.2128	critic_loss:               0.3520	pg_loss:                  -8.4205
q_taken_mean:             -8.1145	target_mean:              -7.8043	td_error_abs:              0.4874	
[INFO 14:26:56] main t_env: 196560 / 500000
[INFO 14:26:56] main Estimated time left: 4 hours, 7 minutes, 34 seconds. Time passed: 2 hours, 36 minutes, 50 seconds
[INFO 14:31:03] main t_env: 201600 / 500000
[INFO 14:31:03] main Estimated time left: 4 hours, 4 minutes, 28 seconds. Time passed: 2 hours, 40 minutes, 58 seconds
[INFO 14:31:19] main Recent Stats | t_env:     201600 | Episode:     4472
agent_grad_norm:           0.0000	critic_grad_norm:         65.6638	critic_loss:               0.3354	pg_loss:                  -8.9667
q_taken_mean:             -8.6827	target_mean:              -8.4267	td_error_abs:              0.4724	
[INFO 14:35:10] main t_env: 206640 / 500000
[INFO 14:35:10] main Estimated time left: 3 hours, 59 minutes, 11 seconds. Time passed: 2 hours, 45 minutes, 4 seconds
[INFO 14:39:14] main t_env: 211680 / 500000
[INFO 14:39:14] main Estimated time left: 3 hours, 52 minutes, 38 seconds. Time passed: 2 hours, 49 minutes, 8 seconds
[INFO 14:39:30] main Recent Stats | t_env:     211680 | Episode:     4696
agent_grad_norm:           0.0000	critic_grad_norm:         77.6526	critic_loss:               0.3612	pg_loss:                  -9.3420
q_taken_mean:             -9.0221	target_mean:              -8.8916	td_error_abs:              0.4911	
[INFO 14:43:13] main t_env: 216720 / 500000
[INFO 14:43:13] main Estimated time left: 3 hours, 43 minutes, 42 seconds. Time passed: 2 hours, 53 minutes, 7 seconds
[INFO 14:47:08] main t_env: 221760 / 500000
[INFO 14:47:08] main Estimated time left: 3 hours, 36 minutes, 34 seconds. Time passed: 2 hours, 57 minutes, 2 seconds
new test result : -1204.5357313611112
[INFO 14:47:23] main Recent Stats | t_env:     221760 | Episode:     4920
agent_grad_norm:           0.0000	critic_grad_norm:         54.7367	critic_loss:               0.2796	pg_loss:                  -9.7205
q_taken_mean:             -9.3540	target_mean:              -9.3283	td_error_abs:              0.4227	
[INFO 14:51:12] main t_env: 226800 / 500000
[INFO 14:51:12] main Estimated time left: 3 hours, 40 minutes, 5 seconds. Time passed: 3 hours, 1 minutes, 6 seconds
[INFO 14:55:04] main t_env: 231840 / 500000
[INFO 14:55:04] main Estimated time left: 3 hours, 26 minutes, 17 seconds. Time passed: 3 hours, 4 minutes, 59 seconds
[INFO 14:55:15] main Recent Stats | t_env:     231840 | Episode:     5144
agent_grad_norm:           0.0000	critic_grad_norm:         58.0550	critic_loss:               0.2862	pg_loss:                 -10.1195
q_taken_mean:             -9.9338	target_mean:              -9.8060	td_error_abs:              0.4317	
[INFO 14:58:26] main t_env: 236880 / 500000
[INFO 14:58:26] main Estimated time left: 2 hours, 55 minutes, 9 seconds. Time passed: 3 hours, 8 minutes, 20 seconds
